# Indoor Map Designer

ä¸€ä¸ªåŸºäº Web çš„å®¤å†…åœ°å›¾è®¾è®¡å™¨ï¼Œç”¨äºåˆ›å»ºæ¥¼å±‚å¹³é¢å›¾å¹¶å¯¼å‡º GeoJSON æ ¼å¼ï¼Œæ”¯æŒå®¤å†…å¯¼èˆªå’Œå®šä½åº”ç”¨ã€‚

## å…³æ³¨æˆ‘è·å¾—æ›´å¤šå®¤å†…å®šä½æŠ€æœ¯
![ç¨‹åºå‘˜çŸ³ç£Š](https://github.com/zhangleino1/Indoor-Map-Designer/blob/main/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¨ ç»˜å›¾å·¥å…·
- **å¢™ä½“/çº¿æ®µ**ï¼šå¤šç‚¹ç»˜åˆ¶ï¼Œæ”¯æŒ T å‹ã€L å‹ç­‰å¤æ‚å¢™ä½“
- **æˆ¿é—´/çŸ©å½¢**ï¼šæ‹–æ‹½ç»˜åˆ¶çŸ©å½¢æˆ¿é—´
- **å¤šè¾¹å½¢**ï¼šè‡ªç”±å¤šè¾¹å½¢ç»˜åˆ¶
- **é—¨çª—**ï¼šå¯è°ƒèŠ‚å®½åº¦å’Œæ—‹è½¬è§’åº¦
- **å…´è¶£ç‚¹ï¼ˆPOIï¼‰**ï¼šç”µæ¢¯ã€æ¥¼æ¢¯ã€æ´—æ‰‹é—´ã€å‡ºå…¥å£ç­‰å¤šç§ç±»å‹
- **æ–‡æœ¬æ ‡ç­¾**ï¼šä¸ºæˆ¿é—´æ·»åŠ æ–‡å­—æ³¨é‡Šï¼Œæ”¯æŒå­—ä½“ã€é¢œè‰²ã€æ—‹è½¬ç­‰æ ·å¼
- **å¯¼èˆªè·¯å¾„**ï¼šç»˜åˆ¶å¯¼èˆªè·¯çº¿
- **å¯¼èˆªèŠ‚ç‚¹**ï¼šæ ‡è®°å¯¼èˆªå…³é”®ç‚¹

### ğŸ¯ é«˜çº§ç¼–è¾‘åŠŸèƒ½
- **æ§åˆ¶ç‚¹ç¼–è¾‘**ï¼šé€‰ä¸­å…ƒç´ åå¯æ‹–åŠ¨æ§åˆ¶ç‚¹è°ƒæ•´å½¢çŠ¶
  - æ‹–åŠ¨æ§åˆ¶ç‚¹å®æ—¶è°ƒæ•´å¢™ä½“ã€è·¯å¾„å½¢çŠ¶
  - ç‚¹å‡»æ§åˆ¶ç‚¹ + Delete åˆ é™¤è¯¥ç‚¹
  - é€‰ä¸­å…ƒç´  + Backspace å¿«é€Ÿåˆ é™¤æœ€åä¸€ä¸ªç‚¹
  - è‡ªåŠ¨å¸é™„ç½‘æ ¼å’Œç«¯ç‚¹
- **å¤šæ®µè¿ç»­ç»˜å›¾**ï¼šæ— éœ€é€€å‡ºå·¥å…·å³å¯ç»˜åˆ¶å¤šä¸ªåˆ†ç¦»çš„å›¾å½¢æ®µ
- **ç²¾ç¡®å°ºå¯¸**ï¼šå®æ—¶æ˜¾ç¤ºé•¿åº¦ã€é¢ç§¯ç­‰å°ºå¯¸ä¿¡æ¯
- **å¤šæ¥¼å±‚æ”¯æŒ**ï¼šç®¡ç†å¤šä¸ªæ¥¼å±‚ï¼Œç‹¬ç«‹ç¼–è¾‘

### ğŸ§­ å¯¼èˆªç½‘ç»œ
- **è‡ªåŠ¨èŠ‚ç‚¹å…³è”**ï¼šå¯¼èˆªè·¯å¾„è‡ªåŠ¨å…³è”èµ·æ­¢èŠ‚ç‚¹
- **åŒå‘è·¯å¾„æ”¯æŒ**ï¼šæ”¯æŒå•å‘/åŒå‘å¯¼èˆªè·¯å¾„
- **Python æ ¼å¼å…¼å®¹**ï¼šå¯¼å‡ºç¬¦åˆ Python å¯¼èˆªåº“æ ‡å‡†çš„ GeoJSON
- **æ˜¾å¼è¾¹æ ¼å¼ï¼ˆv2.0ï¼‰**ï¼šç›´æ¥å¯¼å‡ºè·¯å¾„-èŠ‚ç‚¹å…³è”å…³ç³»

### ğŸ“¤ å¯¼å‡ºåŠŸèƒ½
- **GeoJSON**ï¼šæ”¯æŒå¯¼å‡ºæ‰€æœ‰å…ƒç´ ç±»å‹ï¼ˆå¢™ä½“ã€æˆ¿é—´ã€é—¨çª—ã€POIã€æ–‡æœ¬ã€å¯¼èˆªç½‘ç»œï¼‰
- **PNG å›¾ç‰‡**ï¼šæ”¯æŒ 1x/2x/4x é«˜æ¸…å¯¼å‡º
- **SVG çŸ¢é‡å›¾**ï¼šå¯ç¼©æ”¾çŸ¢é‡å›¾å½¢å¯¼å‡º
- **3D é¢„è§ˆ**ï¼šåŸºäº Three.js çš„ 3D æ¨¡å‹é¢„è§ˆ

### âš™ï¸ ç²¾ç¡®å·¥å…·
- **ç½‘æ ¼å¸é™„**ï¼šå¯¹é½åˆ°ç½‘æ ¼
- **ç«¯ç‚¹å¸é™„**ï¼šå¸é™„åˆ°å…¶ä»–å…ƒç´ ç«¯ç‚¹
- **ä¸­ç‚¹å¸é™„**ï¼šå¸é™„åˆ°çº¿æ®µä¸­ç‚¹
- **è§’åº¦å¸é™„**ï¼šå›ºå®šè§’åº¦ï¼ˆ0Â°/45Â°/90Â°ï¼‰ç»˜åˆ¶

### ğŸ“‹ å†å²ç®¡ç†
- **å®Œæ•´æ’¤é”€/é‡åš**ï¼šæ”¯æŒæ‰€æœ‰æ“ä½œçš„æ’¤é”€é‡åš
- **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒå¤šé€‰åˆ é™¤ã€ç§»åŠ¨ç­‰
- **æ™ºèƒ½å†å²**ï¼šè‡ªåŠ¨åˆå¹¶æ‰¹é‡æ“ä½œ

## ğŸ›  æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Vue 3 + TypeScript
- **çŠ¶æ€ç®¡ç†**: Pinia
- **UI åº“**: Element Plus
- **å›¾å½¢æ¸²æŸ“**: HTML5 Canvas + SVG
- **3D æ¸²æŸ“**: Three.js
- **åç«¯**: Node.js + Express
- **æ„å»ºå·¥å…·**: Vite

## ğŸ¬ åº”ç”¨åœºæ™¯

- **å®¤å†…å¯¼èˆªç³»ç»Ÿ**ï¼šå•†åœºã€åŒ»é™¢ã€æœºåœºç­‰å¤§å‹å»ºç­‘çš„å¯¼èˆª
- **è§†è§‰å®šä½**ï¼šé…åˆè§†è§‰ SLAM ç³»ç»Ÿè¿›è¡Œå®¤å†…å®šä½
- **æœºå™¨äººè·¯å¾„è§„åˆ’**ï¼šå®¤å†…æœåŠ¡æœºå™¨äººçš„è·¯å¾„è§„åˆ’
- **åº”æ€¥ç–æ•£**ï¼šå»ºç­‘ç‰©åº”æ€¥ç–æ•£è·¯çº¿è®¾è®¡
- **ç©ºé—´åˆ†æ**ï¼šå®¤å†…ç©ºé—´åˆ©ç”¨ç‡åˆ†æ

## Getting Started

### Prerequisites

- Node.js 18+
- npm or pnpm

### Installation

```bash
# Install all dependencies
npm run install:all

# Or install separately
cd client && npm install
cd ../server && npm install
```

### Development

```bash
# Run both client and server
npm run dev

# Or run separately
npm run dev:client  # Frontend on http://localhost:3000
npm run dev:server  # Backend on http://localhost:3001
```

### Build

```bash
npm run build
```

## Usage

### Keyboard Shortcuts

#### Tool Selection

| Key | Tool |
|-----|------|
| `V` | Select tool |
| `W` | Wall/Line tool |
| `Shift+W` | Window tool |
| `D` | Door tool |
| `R` | Room/Rectangle tool |
| `P` | Polygon tool |
| `M` | POI marker tool |
| `T` | Text/Label tool |
| `O` | Navigation node tool |
| `N` | Navigation path tool |

#### Drawing Mode (When Using Multi-point Tools)

**Multi-point tools**: Wall, NavPath, Polygon

| Key/Action | Effect |
|------------|--------|
| **Left Click** | Add point to current segment |
| **Double Click** | Finish current segment, stay in tool (can draw next segment) |
| **Right Click** | Finish current segment, stay in tool |
| **Enter** | Finish current segment, stay in tool |
| **Ctrl+Z** | Remove last point from current drawing |
| **Backspace** | Remove last point from current drawing |
| **Escape** | Cancel drawing and exit tool (switch to Select) |

**ğŸ’¡ Tip**: You can now draw multiple disconnected segments without exiting the tool!
- Example: Draw T-shaped wall â†’ horizontal segment (double-click) â†’ vertical segment (double-click) â†’ Escape

#### Global Shortcuts

| Key | Action |
|-----|--------|
| **Ctrl+Z** | Undo (or remove last point when drawing) |
| **Ctrl+Shift+Z** | Redo |
| **Delete** | Delete selected elements |
| **Backspace** | Delete selected elements (or remove last point when drawing) |
| **Escape** | Cancel drawing / Clear selection / Exit tool |
| **Space** | Hold to enable pan mode (drag with mouse) |

### Mouse Controls

| Action | Effect |
|--------|--------|
| **Left Click** | Draw point / Select element |
| **Left Drag** | Draw rectangle (Room/Corridor/Hall) / Move selected element |
| **Double Click** | Finish current segment (multi-point tools) |
| **Right Click** | Finish current segment (when drawing) |
| **Ctrl + Scroll** | Zoom in/out |
| **Scroll** | Pan canvas vertically |
| **Shift + Scroll** | Pan canvas horizontally |
| **Middle Button Drag** | Pan canvas |
| **Space + Left Drag** | Pan canvas |

### Drawing Workflow Examples

#### Example 1: T-Shaped Wall
```
1. Press W (wall tool)
2. Click point 1 â†’ point 2 â†’ double-click (horizontal wall complete)
3. Click point 3 â†’ point 4 â†’ double-click (vertical wall complete, no connection!)
4. Press Escape (exit tool)
```

#### Example 2: Multiple Rooms
```
1. Press R (room tool)
2. Drag first room â†’ release
3. Drag second room â†’ release
4. Drag third room â†’ release
...
n. Press Escape when done
```

#### Example 3: Complex Navigation Path
```
1. Press N (navpath tool)
2. Click points for route A â†’ double-click (route A complete)
3. Click points for route B â†’ double-click (route B complete)
4. Click points for route C â†’ double-click (route C complete)
5. Press Escape (exit tool)
```

#### Example 4: Fix Wrong Point While Drawing
```
1. Drawing wall: point 1 â†’ point 2 â†’ point 3
2. Oops! Point 3 is wrong
3. Press Ctrl+Z (point 3 removed)
4. Click correct point 3 â†’ continue drawing
5. Double-click to finish
```

## GeoJSON Output Format

```json
{
  "type": "FeatureCollection",
  "properties": {
    "name": "Building Name",
    "scale": 1,
    "unit": "cm"
  },
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [[[0,0], [500,0], [500,400], [0,400], [0,0]]]
      },
      "properties": {
        "id": "room-001",
        "type": "room",
        "floor": 1,
        "name": "Living Room",
        "area": 200000
      }
    }
  ]
}
```

## Project Structure

```
indoor-map-designer/
â”œâ”€â”€ client/                 # Vue 3 frontend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # Vue components
â”‚   â”‚   â”œâ”€â”€ stores/         # Pinia stores
â”‚   â”‚   â”œâ”€â”€ types/          # TypeScript types
â”‚   â”‚   â””â”€â”€ utils/          # Utility functions
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ server/                 # Node.js backend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/         # API routes
â”‚   â”‚   â””â”€â”€ index.ts        # Entry point
â”‚   â””â”€â”€ package.json
â””â”€â”€ package.json            # Root package.json
```

## License

MIT
